#!/bin/bash

# GitHub Actions ì›Œí¬í”Œë¡œìš° ê²€ì¦
echo "ğŸ” ê²€ì¦ ì¤‘: GitHub Actions ì›Œí¬í”Œë¡œìš° íŒŒì¼"

# actionlint ì‹¤í–‰
if [ -f "./actionlint" ]; then
    ./actionlint .github/workflows/ci.yml
    if [ $? -ne 0 ]; then
        echo "âŒ ì›Œí¬í”Œë¡œìš° íŒŒì¼ ê²€ì¦ ì‹¤íŒ¨. í‘¸ì‹œ ì¤‘ë‹¨."
        echo "ğŸ’¡ ìˆ˜ì • í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”."
        exit 1
    fi
else
    echo "âš ï¸  actionlintë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì›Œí¬í”Œë¡œìš° ê²€ì¦ì„ ê±´ë„ˆëœë‹ˆë‹¤."
fi

# YAML êµ¬ë¬¸ ê²€ì¦
echo "ğŸ” YAML êµ¬ë¬¸ ê²€ì¦ ì¤‘..."
python3 -c "
import yaml
import sys
try:
    with open('.github/workflows/ci.yml', 'r') as f:
        yaml.safe_load(f)
    print('âœ… YAML êµ¬ë¬¸ ê²€ì¦ ì„±ê³µ')
except yaml.YAMLError as e:
    print(f'âŒ YAML êµ¬ë¬¸ ì˜¤ë¥˜: {e}')
    sys.exit(1)
except Exception as e:
    print(f'âŒ íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: {e}')
    sys.exit(1)
"

if [ $? -eq 0 ]; then
    echo "âœ… ëª¨ë“  ê²€ì¦ í†µê³¼! í‘¸ì‹œë¥¼ ì§„í–‰í•©ë‹ˆë‹¤."
    exit 0
else
    echo "âŒ ê²€ì¦ ì‹¤íŒ¨. í‘¸ì‹œ ì¤‘ë‹¨."
    exit 1
fi
